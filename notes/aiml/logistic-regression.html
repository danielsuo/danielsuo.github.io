<!doctype html>
<html>
  
  <head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="chrome=1">
<title>Daniel Suo | Scientific progress goes 'boink'</title>

<link rel="stylesheet" href="/assets/css/styles.css">
<link rel="stylesheet" href="/assets/css/pygment_trac.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">
<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
<link rel="shortcut icon" href="/assets/img/profile.jpg" />

<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"> </script>



<script type="text/javascript"
   src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [ ['$','$'], ['\\(','\\)'] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    }
  });
</script>







<script src="https://d3js.org/d3.v3.min.js"></script>

<script src="https://wzrd.in/standalone/function-plot@1.17.3"></script>




<!--[if lt IE 9]>
<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]-->
</head>


  <body id=''>
    
    <div class='wrapper'>
      
      <header>
    <h1>Daniel Suo</h1>
    <p>Scientific progress goes 'boink'</p>

    <p>
      Ph.D. Candidate<br>
      Princeton University<br>
      Department of Computer Science
    </p>

    <ul>
    	<li><a href="/">home</a></li>
      <!-- <li><a href="https://blog.danielsuo.com">blog</a></li>
      <li><a href="/projects">projects</a></li> -->
      <li><a href="/notes">notes</a></li>
    </ul>

</header>


      <section>

        <div id='container'>
          <h1 id="logistic-regression">Logistic regression</h1>

<h2 id="the-classification-problem">The classification problem</h2>

<p>While we’re often interested predicting continuous variables based on some input variables (e.g., home price based on number of bedrooms), there are many cases where we want to predict binary outcomes (e.g., it will snow tomorrow). In this case, the input variables may be continuous or not. We will investigate the case where we want to predict some category (e.g., this picture is of a cat, dog, or mouse) at some later point.</p>

<p>A quick note on taxonomy: regression models typically predict continuous values whereas classification models typically predict discrete values (i.e., classes). Logistic regressions are often used as classifiers. A cliffhanger! We will resolve this seeming inconsistency soon.</p>

<p>But we’re interested in more than just categorizing input variables into two classes “yes” and “no” (this problem is called binary classification). We’d also like some measure of how likely our response $Y$ of “yes” or “no” is given the input data, $X$. In other words, we’d like the conditional probability distribution of $Y$ on $X$, $\Pr(Y|X).$</p>

<h2 id="a-statisticians-approach">A statistician’s approach</h2>

<p>Let’s rename our classes 1 (“yes”) and 0 (“no”). $Y$ becomes an indicator random variable, which is just a fancy way of saying $Y$ is a random variable associated with whether an event (call it $A$) happens or not. To be completely explicit:</p>

<script type="math/tex; mode=display">% <![CDATA[
Y = \left\{
\begin{array}{ll}
1 & \textrm{if }A\\
0 & \textrm{otherwise}
\end{array}
\right. %]]></script>

<p>By the definition of expectation, indicator random variables have the property that</p>

<script type="math/tex; mode=display">\mathbf{E}[Y] = \Pr(Y = 1)\\
\mathbf{E}[Y | X] = \Pr(Y = 1 | X = x)</script>

<p>We could just use a linear regression on the input data to predict $Y$, but this ignores the fact that we’d like to model probabilities and probabilities must stay between 0 and 1! How might we model $p = \Pr(Y = 1)$? One simple thing to do is to take each datapoint $x_i$ and the corresponding output $y_i$ and maximize the probability of all the $y_i$ occurring, given the corresponding $x_i$.</p>

<script type="math/tex; mode=display">\prod_{i=1}^n \Pr(Y=y_i | X=x_i) = \prod_{i=1}^n p^{y_i}(1-p)^{1-y_i}</script>

<p>Of course, the right-hand side is maximized when $p = \hat{p} = \sum_{i=1}^n y_i / n$. But hang on, do we really want $p$ to be the same regardless of $x_i$? Surely it’s more likely to rain when there are storm clouds gathering than during a cloudless, sunny day. Here is a revised likelihood function:</p>

<script type="math/tex; mode=display">\prod_{i=1}^n \Pr(Y=y_i | X=x_i) = \prod_{i=1}^n p_i^{y_i}(1-p_i)^{1-y_i}</script>

<p>Getting warmer, though a closer look tells us that this function doesn’t tell us anything. We can maximize it by setting $\hat{p}_i = y_i$. Once again, we ignore $x_i$. We need some constraints on $p_i$ that force it to depend on $x_i$ and establish some consistency across the $x_i$ we see: $p_i = p(x_i;\theta)$, where we assume some function $p$ and try to estimate $\theta$ by maximizing the new likelihood function:</p>

<script type="math/tex; mode=display">\prod_{i=1}^n \Pr(Y=y_i | X=x_i) = \prod_{i=1}^n p(x_i;\theta)^{y_i}(1-p(x_i;\theta))^{1-y_i}</script>

<h2 id="logistic-regression-1">Logistic regression</h2>
<p>It so happens that the machinery people have developed for linear regressions are so handy that we ask ourselves how we might use linear regressions to estimate the unknown parameters in our probability function.</p>

<ol>
  <li>
    <p>The simplest approach is to let $p(x)$ be a linear function of $x$ (with $\theta$ as the corresponding coefficients). The problem, though, is linear functions are unbounded, whereas probabilities are bounded between 0 and 1. It’s also worth noting that in many problems, we need a much bigger change in $x$ to change $p$ when $p$ is already very close to 1 or 0.</p>
  </li>
  <li>
    <p>After some futzing, we see that</p>
  </li>
</ol>

<script type="math/tex; mode=display">\log \frac{p}{1 - p} = \beta_0 + x\cdot \beta</script>

<p>gives us the two properties that we want: bounded between 1 and 0 regardless of $x$, and small changes in $p$ with respect to $x$ as $p$ gets close to 0 or 1. In the plot below, we let</p>

<script type="math/tex; mode=display">u=\beta_0 + x\cdot\beta</script>

<p>for simplicity.</p>

<div id="quadratic"></div>

<script>
functionPlot({
  disableZoom: true,
  xAxis: {
    label: 'u - axis'
  },
  yAxis: {
    label: 'p - axis',
    domain: [0, 1.2]
  },
  target: '#quadratic',
  data: [{
    fn: '1 / (1 + exp(-x))'
  }],
  grid: true
})
</script>

<h2 id="comparing-linear-and-logistic-regressions">Comparing linear and logistic regressions</h2>

<h2 id="examining-how-logistic-regression-changes-based-on-parameters">Examining how logistic regression changes based on parameters</h2>

<h2 id="the-decision-boundary">The decision boundary</h2>

<h2 id="maximizing-the-likelihood-function-for-logistic-regression">Maximizing the likelihood function for logistic regression</h2>

<h2 id="logistic-regression-with-more-than-two-classes-multinomial-regression">Logistic regression with more than two classes (multinomial regression)</h2>

<h2 id="further-topics">Further topics</h2>
<ul>
  <li>Newton’s method in one or more dimensions</li>
  <li>Iteratively re-weighted least squares</li>
  <li>Generalized linear models</li>
</ul>

<h2 id="questions-to-answer">Questions to answer</h2>
<ul>
  <li><a href="https://www.quora.com/Why-is-logistic-regression-called-regression-if-it-doesnt-model-continuous-outcomes">Why is it called a regression?</a></li>
</ul>

<h2 id="references">References</h2>
<ul>
  <li><a href="https://www.stat.cmu.edu/~cshalizi/uADA/12/lectures/ch12.pdf">Introduction 1</a></li>
  <li><a href="http://data.princeton.edu/wws509/notes/c3.pdf">Introduction 2</a></li>
  <li><a href="http://www.mc.vanderbilt.edu/gcrc/workshop_files/2004-11-12.pdf">Basic Introduction</a></li>
</ul>

        </div>

      </section>

      <footer>
  <!--email_off-->
    <small>Complain <a href="mailto:dsuo@cs.princeton.edu" target="_blank">here</a>.</small>
  <!--/email_off-->
  <small><a href="/pubkey.txt" target="_blank">Securely</a>.</small>
</footer>

      
    </div>

    <script src='/assets/js/scale.fix.js'></script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-37351701-1', 'auto');
  ga('send', 'pageview');
</script>

  </body>
</html>